{% extends 'admintools/base.html' %}
{% load tags %}
{% block body %}
<div class="container">
    <!--Page padding-->
    <br /><br /><br />
    <a href="#" style="margin-bottom: 10px;" class="list-group-item active teal lighten-1">
        All Patches
    </a>
    <form class="form-inline" method="get" action="{% url 'list_all_person_patches' jur_name %}">
        <div class="md-form form-group">
            <label style="margin-top: -8px;"><strong>Category</strong></label>
          <select name="category" class="custom-select mb-2 mr-sm-2 mb-sm-0" style="margin-left: 80px;">
            <option value="" {% if not category_search %}selected{% endif %}>All</option>
            {% for k, v in categories_ %}
                <option value="{{k}}" {% if category_search == k %}selected{% endif %}>{{v}}</option>
            {% endfor %}
          </select>
      </div>
        <div class="md-form form-group">
            <label style="margin-top: -8px;"><strong style="margin-left: -20px;">Alert</strong></label>
            <select name="alert" class="custom-select mb-2 mr-sm-2 mb-sm-0" style="margin-left: 20px;">
              <option value="" {% if not alert_search %}selected{% endif %}>All</option>
             {% for k, v in alerts_ %}
              <option value="{{k}}" {% if alert_search == k %}selected{% endif %}>{{v}}</option>
             {% endfor %}
            </select>
        </div>
        <div class="md-form form-group">
            <label style="margin-top: -8px;"><strong style="margin-left: -20px;">By</strong></label>
            <select name="applied_by" class="custom-select mb-2 mr-sm-2 mb-sm-0" style="margin-left: 5px;">
              <option value="" {% if not applied_by_search %}selected{% endif %}>All</option>
              <option value="admin" {% if applied_by_search == 'admin' %}selected{% endif %}>Admin</option>
              <option value="user" {% if applied_by_search == 'user' %}selected{% endif %}>User</option>
            </select>
        </div>
        <div class="md-form form-group">
            <label style="margin-top: -8px;"><strong style="margin-left: -22px;">Status</strong></label>
            <select name="status" class="custom-select mb-2 mr-sm-2 mb-sm-0" style="margin-left: 30px;">
              <option value="" {% if not status_search %}selected{% endif %}>All</option>
             {% for k, v in status_ %}
              <option value="{{k}}" {% if status_search == k %}selected{% endif %}>{{v}}</option>
             {% endfor %}
            </select>
        </div>
        <div class="md-form form-group">
            <label style="margin-top: -8px;" for="person_input"><strong>Person</strong></label>
            <input style="text-align:center;margin-bottom: 20px;" type="text" name="person" id="person_input" value="{{ request.GET.person}}" />
        </div>
        <div class="md-form form-group">
            <button class="btn btn-cyan" type="submit">Go</button>
        </div>
    </form>
    <table class="table table-bordered table-striped">
      <thead>
        <tr class="table-active">
          <th>Person</th>
          <th>Old Value</th>
          <th>New Value</th>
          <th>Note</th>
          <th style="width:4%">Source</th>
          <th style="text-align: center;">Reporter</th>
          <th style="text-align: center;">Status</th>
        </tr>
      </thead>
      <tbody>
         {% for patch in patches %}
            <tr class="hoverable">
              <td><a href="{% url 'admin:core_person_change' patch.object_id %}">{% person_from_id patch.object_id %}</a></td>
              <td>{{ patch.old_value }}</td>
              <td>{{ patch.new_value }}</td>
              <td>{{ patch.note }}</td>
              <td style="text-align: center;">
                  <a href="{{ patch.source }}"><i class="fa fa-external-link" aria-hidden="true"></i></a>
              </td>
              <td style="text-align: center;">{{ patch.reporter_email }}</td>
              <td style="text-align: center;">{{ patch.status }}</td>
            </tr>
        {% empty %}
         <h3>No Patches Available!</h3><br />
        {% endfor %}
      </tbody>
    </table>
{% if patches.has_other_pages %}
<br />
<nav>
<ul class="pagination pagination-md">
    {% if patches.has_previous %}
    <li class="page-item ">
        <a class="page-link" href="?{% url_replace request 'page' 1 %}" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
        <span class="sr-only">Previous</span>
      </a>
    </li>
    {% endif %} {% for i in page_range %} {% if patches.number == i %}
    <li class="page-item active">
        <a class="page-link" href="#">{{ i }}<span class="sr-only">(current)</span></a>
    </li>
    {% else %}
    <li class="page-item"><a class="page-link" href="?{% url_replace request 'page' i %}">{{i}}</a></li>
    {% endif %} {% endfor %} {% if patches.has_next %}
    <li class="page-item">
        <a class="page-link" href="?{% url_replace request 'page' patches.paginator.num_pages %}" aria-label="Next">
      <span aria-hidden="true">&raquo;</span>
      <span class="sr-only">Next</span>
    </a>
    </li>
    {% endif %}
</ul>
<span>
    Page {{ patches.number }} of {{ patches.paginator.num_pages }}. (Total {{ patches.paginator.count }} Results)
</span>
</nav>
{% endif %}<br /><br />
</div>
{% endblock %}
